<!DOCTYPE html>
<html>
<head>
    <title>Psych Season</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="css/personal.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<script>

    function openView(id, evt, section) 
    {
        // Declare all variables
        var i, tabcontent, tablinks;

        // Get all elements with class="tabcontent" and hide them
        tabcontent = document.getElementsByClassName("tabcontent");
        for (i = 0; i < tabcontent.length; i++) 
        {
            tabcontent[i].style.display = "none";
        }

        // Get all elements with class="tablinks" and remove the class "active"
        tablinks = document.getElementsByClassName("tablinks");
        for (i = 0; i < tablinks.length; i++) 
        {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }

        // Show the current tab, and add an "active" class to the button that opened the tab
        document.getElementById(section).style.display = "block";
        evt.currentTarget.className += " active";
        server(id);
    }

    function get_data(id)
    {
      document.location = '/details?id=' + id;
    }

   function server(id)
   {
      var url = location.href;
      var address = 'season?number=' + id;
      var query = url + address;

      var page = new XMLHttpRequest();
      page.onreadystatechange=function()
      {
         if (page.readyState==4 && page.status==200)
         {
            action(page);
         }
      }
      page.open("GET", query, true);
      page.send();
   }

   function action(xhttp)
   {
      
      var text = JSON.parse(xhttp.responseText);

      
      var txt = "<table><tr><th></th>" + 
                "<th>Episodes</th>" +
                "</tr>";

      for(var i = 0; i < text.episode_id.length; i++)
      {
         if(text.episode_id[i] != null)
         {
            txt += "<tr><th>" + text.episode_number[i] + "</th>";
            txt += "<th><input type='button' id = 'episode_" + 
                  i + "' name='episode_" + i + "' value='" + 
                  text.episode_name[i] + "' onclick='get_data(" + text.episode_id[i] + ")''></text></th>";
         }
      }

      txt += "</table>";
      doc_id = text.season_id[0]; 

      document.getElementById(doc_id).innerHTML = txt;
   }

   function create()
   {
      document.location = '/create';
   }

</script>

<body>

   <div class="psych center">
      <br>
      <h2 class="center">Psych</h2>
      <ul>
         <li><a class="active" href="">View Episodes</a></li>
         <li><a class="" onclick="create()">Add Fun Fact</a></li>
      </ul>
   </div>

   <div class="tab center">

   <button class="tablinks" onclick="openView(1, event, 'Season 1')">Season 1</button>
   <button class="tablinks" onclick="openView(2, event, 'Season 2')">Season 2</button>
   <button class="tablinks" onclick="openView(3, event, 'Season 3')">Season 3</button>
   <button class="tablinks" onclick="openView(4, event, 'Season 4')">Season 4</button> 
   <button class="tablinks" onclick="openView(5, event, 'Season 5')">Season 5</button> 
   <button class="tablinks" onclick="openView(6, event, 'Season 6')">Season 6</button> 
   <button class="tablinks" onclick="openView(7, event, 'Season 7')">Season 7</button> 
   <button class="tablinks" onclick="openView(8, event, 'Season 8')">Season 8</button> 
</div>

<!-- Tab content -->

<div id="Season 1" class="tabcontent center">
   <span onclick="this.parentElement.style.display='none'" class="topright">&times</span>
   <h3>Season 1</h3>
   <div id="1" class = "inner-left left">

   </div>   
</div>

<div id="Season 2" class="tabcontent center">
   <span onclick="this.parentElement.style.display='none'" class="topright">&times</span>
   <h3>Season 2</h3>
   <div id="2" class = "inner-left left">

   </div>   
</div>

<div id="Season 3" class="tabcontent center">
   <span onclick="this.parentElement.style.display='none'" class="topright">&times</span>
   <h3>Season 3</h3>
   <div id="3" class = "inner-left left">

   </div>   
</div>

<div id="Season 4" class="tabcontent center">
   <span onclick="this.parentElement.style.display='none'" class="topright">&times</span>
   <h3>Season 4</h3>
   <div id="4" class = "inner-left left">

   </div>   
</div>

<div id="Season 5" class="tabcontent center">
   <span onclick="this.parentElement.style.display='none'" class="topright">&times</span>
   <h3>Season 5</h3>
   <div id="5" class = "inner-left left">

   </div>   
</div>

<div id="Season 6" class="tabcontent center">
   <span onclick="this.parentElement.style.display='none'" class="topright">&times</span>
   <h3>Season 6</h3>
   <div id="6" class = "inner-left left">

   </div>   
</div>

<div id="Season 7" class="tabcontent center">
   <span onclick="this.parentElement.style.display='none'" class="topright">&times</span>
   <h3>Season 7</h3>
   <div id="7" class = "inner-left left">

   </div>   
</div>

<div id="Season 8" class="tabcontent center">
   <span onclick="this.parentElement.style.display='none'" class="topright">&times</span>
   <h3>Season 8</h3>
   <div id="8" class = "inner-left left">

   </div>   
</div>
</body>
</html>